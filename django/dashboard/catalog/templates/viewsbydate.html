{% extends 'base.html' %}

{% block content %}

<div class='container'>
  <div class="row">
    <div class="col-sm-12 text-center">
      <h1></h1>
    </div>
  </div>
  <div class="row" style="height: 900px">
    <div id="mycontainer" style="width: 100%; height: 100%"></div>
    </div>
  </div>
</div>

{% endblock content %}
<script>
  {% block jquery %}
  var endpoint = '/api/videos/viewsbydate/'
  var defaultData = []
  var labels = []
  $.ajax({
    method: "GET",
    url: endpoint,
    success: function(data){
      console.log(data);
      var table, mapping, chart;
      anychart.onDocumentReady(function () {
      table = anychart.data.table();
      var dict = data.all_data;
      var arr = [];
      for (var key in dict) {
          if (dict.hasOwnProperty(key)) {
              arr.push( [ key, dict[key] ] );
          }
      }
      table.addData(arr);
      // mapping the data
      mapping = table.mapAs();
      mapping.addField('value', 1);
      // defining the chart type
      chart = anychart.stock();
      // set the series type
      chart.plot(0).column(mapping).name('Number Of Views');
      // setting the chart title
      chart.title('Political Ads: Total Views By Date');
      // display the chart
      chart.container('mycontainer');
      chart.draw();
      });
    }
  });
  console.log("I am Here")
  {% endblock %}
  </script>
